<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Einführung in Async / Await &#8211; LernMoment.de</title>
<meta name="description" content="wie du einfach asynchron Daten liest">
<meta name="keywords" content="Async, File">


<!-- Twitter Cards -->
<meta name="twitter:title" content="Einführung in Async / Await">
<meta name="twitter:description" content="wie du einfach asynchron Daten liest">



<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:63266/images/banner/lernmoment-csharp.jpg">

<!-- Open Graph -->
<meta property="og:locale" content="de_DE">
<meta property="og:type" content="article">
<meta property="og:title" content="Einführung in Async / Await">
<meta property="og:description" content="wie du einfach asynchron Daten liest">
<meta property="og:url" content="http://localhost:63266/csharp-programmieren/einfuehrung-in-async-und-await/">
<meta property="og:site_name" content="LernMoment.de">

<!-- Webmaster Tools verfication -->
<meta name="google-site-verification" content="sPPXWqQjaSqa_ZgqYPNCyVLLaFzVAFCuf3xDBC-ofwE">



<link rel="canonical" href="http://localhost:63266/csharp-programmieren/einfuehrung-in-async-und-await/">
<link href="http://localhost:63266/feed.xml" type="application/atom+xml" rel="alternate" title="LernMoment.de Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:63266/assets/css/main.css">
<!-- Webfonts -->
<script src="//use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="http://localhost:63266/assets/js/vendor/html5shiv.min.js"></script>
  <script src="http://localhost:63266/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://localhost:63266/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:63266/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:63266/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:63266/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:63266/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:63266/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:63266/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post">



<div class="navigation-banner">
	
	

	Lerne programmieren mit mir im Kurs: <a href="http://localhost:63266/einstieg-csharp/" >Einstieg in C# -></a>
</div>


<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
      
		    
		    <li><a href="http://localhost:63266/kurse/" >Kurse</a></li>
		  
		    
		    <li><a href="http://localhost:63266/schwerpunkt/" >Dein Weg zum C# Entwickler</a></li>
		  
		    
		    <li><a href="http://localhost:63266/projekt-start/" >Entwicklung & Mentoring</a></li>
		  
		    
		    <li><a href="http://localhost:63266/blog/" >Blog</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<header class="masthead">
	
		<div class="wrap">
			<a href="http://localhost:63266/" class="site-logo" rel="home" title="LernMoment.de"><img src="http://localhost:63266/images/site-logo.png" width="200" height="200" alt="LernMoment.de logo" class="animated fadeInDown"></a>
		</div>
	
</header><!-- /.masthead -->


<div class="js-menu-screen menu-screen"></div>


<div id="main" role="main">
  <article class="hentry">
    <img src="http://localhost:63266/images/banner/lernmoment-csharp.jpg" class="entry-feature-image" alt="Einführung in Async / Await" >
    <div class="entry-wrapper">
      <header class="entry-header">
        <span class="entry-tags"><a href="http://localhost:63266/tags/#Async" title="Pages tagged Async">Async</a>&nbsp;&bull;&nbsp;<a href="http://localhost:63266/tags/#File" title="Pages tagged File">File</a></span>
        
          <h1 class="entry-title">Einführung in Async / Await</h1>
        
      </header>
      <footer class="entry-meta">
        
        <span class="author vcard">Von <span class="fn">Jan Suchotzki</span></span>
        <span class="entry-date date published"><time datetime="2015-07-22T11:25:00+02:00"><i class="fa fa-calendar-o"></i> 22. July 2015</time></span>
        <span class="entry-date date modified"><time datetime="2016-03-10 20:00:00 +0200"><i class="fa fa-pencil"></i> 10. March 2016</time></span>
        
        
        
      </footer>
      <div class="entry-content">
        <p>Seit mittlerweile 3 Jahren gibt es .NET 4.5. In dieser Version wurden die Schlüsselwörter <code class="highlighter-rouge">async / await</code> eingeführt. Sie sollen eine sehr einfache Methode zur asynchronen Programmierung bereitstellen.</p>

<p>Auch die Klasse <code class="highlighter-rouge">StreamReader</code> wurde erweitert um dieses neue Konzept zu unterstützen. Insgesamt wurden 4 zusätzliche Async-Methoden hinzugefügt. Die Methode <code class="highlighter-rouge">ReadLineAsync</code> will ich dir heute in einem Beispiel vorstellen:</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Program</span> <span class="p">{</span>
  <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">Task</span> <span class="n">webTask</span> <span class="p">=</span> <span class="nf">GetWebContentAsync</span><span class="p">();</span>

    <span class="k">while</span><span class="p">(!</span><span class="n">webTask</span><span class="p">.</span><span class="n">IsCompleted</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="s">";o "</span><span class="p">);</span>
      <span class="n">Thread</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="m">100</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"FERTIG!"</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">GetWebContentAsync</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="n">WebClient</span> <span class="n">myClient</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WebClient</span><span class="p">();</span>
    <span class="n">Stream</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">myClient</span><span class="p">.</span><span class="nf">OpenReadTaskAsync</span><span class="p">(</span><span class="s">"http://www.contoso.com/index.htm"</span><span class="p">);</span>
  
    <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">response</span><span class="p">))</span>
    <span class="p">{</span>
      <span class="kt">string</span> <span class="n">line</span><span class="p">;</span>
      <span class="k">while</span><span class="p">((</span><span class="n">line</span> <span class="p">=</span> <span class="k">await</span> <span class="n">reader</span><span class="p">.</span><span class="nf">ReadLineAsync</span><span class="p">())</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">();</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="n">reader</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="n">response</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Wie du siehst, habe ich hier eine einfache Abfrage einer Webseite gemacht. Das wirklich Spannende passiert dabei im Kopf der <code class="highlighter-rouge">while</code> Schleife in der Methode <code class="highlighter-rouge">GetWebContentAsync</code>. Dort siehst du den Aufruf der <code class="highlighter-rouge">ReadLineAsync</code> Methode mit einem vorangestelltem <code class="highlighter-rouge">await</code>.</p>

<p>Genau an dieser Stelle passiert einiges an Magie bzw. der Compiler macht einiges was du bisher machen musstest. Durch das <code class="highlighter-rouge">await</code> wird die Methode <code class="highlighter-rouge">GetWebContentAsync</code> unterbrochen, bis <code class="highlighter-rouge">ReadLineAsync</code> den String von der Webseite geholt hat. Das heißt im Detail:</p>

<ol>
  <li>Der Aufrufer von <code class="highlighter-rouge">GetWebContentAsync</code>, also <code class="highlighter-rouge">Main</code>, wird weiter ausgeführt.</li>
  <li>Der Aufrufer wird wieder unterbrochen, wenn <code class="highlighter-rouge">ReadLineAsync</code> mit einem Resultat zurück ist.</li>
</ol>

<p>Wenn du nach dem Aufruf von <code class="highlighter-rouge">ReadLineAsync</code> noch etwas machen willst, bevor <code class="highlighter-rouge">await</code> aufgerufen wird und somit die asynchrone Methode unterbrochen wird, geht das auch:</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">response</span><span class="p">))</span>
<span class="p">{</span>
  <span class="n">Task</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">readingTask</span> <span class="p">=</span> <span class="n">reader</span><span class="p">.</span><span class="nf">ReadLineAsync</span><span class="p">();</span>

  <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Warte nun auf den StreamReader!"</span><span class="p">);</span>
  <span class="kt">string</span> <span class="n">line</span> <span class="p">=</span> <span class="k">await</span> <span class="n">readingTask</span><span class="p">;</span>
  <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">();</span>
  <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>

  <span class="n">reader</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Wichtig ist allerdings, dass du ein <code class="highlighter-rouge">await</code> aufrufst oder auf eine andere Art auf die asynchrone Methode wartest. Ansonsten können alle möglichen komischen Dinge passieren. Würdest du zum Beispiel das Hauptprogramm verkürzen, dann wird die asynchrone Methode kein Resultat mehr liefern können, weil das Programm bereits beendet ist:</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nf">GetWebContentAsync</span><span class="p">();</span>

  <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"FERTIG!"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Zusätzlich wird automatisch ein <code class="highlighter-rouge">Task</code> Objekt zur Verfügung gestellt. So ist es einfach möglich, die Ausführung der asynchronen Methode zu beobachten. Dies benutze ich in der <code class="highlighter-rouge">Main</code> Methode um einen Fortschritt anzuzeigen.</p>

<p>Es gibt sicherlich noch das ein oder andere zu beachten, aber <code class="highlighter-rouge">async / await</code> machen das asynchrone programmieren wirklich einfach. Trotzdem solltest du wissen was du tust!</p>

<p>Jetzt erstmal viel Spaß beim Warten</p>

<p>Jan</p>

<h3 id="merke">Merke</h3>

<ul>
  <li><code class="highlighter-rouge">StreamReader</code> bietet verschiedene Async-Methoden an, um asynchron Daten aus dem Stream zu lesen.</li>
  <li>Ein <code class="highlighter-rouge">await</code> vor dem Aufruf von <code class="highlighter-rouge">ReadLineAsync</code> macht das Task-Handling und sorgt dafür, dass ein String oder NULL zurückgegeben wird.</li>
  <li>Du kannst auch das <code class="highlighter-rouge">Task&lt;string&gt;</code> Objekt von <code class="highlighter-rouge">ReadLineAsync</code> verwenden, um beispielsweise andere Befehle auszuführen, bevor du <code class="highlighter-rouge">await</code> aufrufst.</li>
  <li>Definierst du eine Methode mit dem <code class="highlighter-rouge">async</code> Schlüsselwort im Methodenkopf, muss im Methodenrumpf wenigstens einmal <code class="highlighter-rouge">await</code> verwendet werden.</li>
</ul>

<h3 id="lernquiz">Lernquiz</h3>

<p>Verwende folgende Fragen um das Gelernte von heute zu festigen:</p>

<ul>
  <li>Welches Schlüsselwort verwendest du in Kombination mit <code class="highlighter-rouge">ReadLineAsync</code> um die Wartezeit nicht zu vertrödeln?</li>
  <li>Was passiert durch die Verwendung von <code class="highlighter-rouge">await</code>?</li>
  <li>Was muss innerhalb einer Methode aufgerufen werden, die <code class="highlighter-rouge">async</code> im Funktionskopf hat?</li>
</ul>

<p>Am besten du schaust dir morgen und dann nochmal in ein paar Tagen die vorherigen Fragen an und beantwortest sie ohne den Text vorher gelesen zu haben.</p>

<h3 id="weitere-informationen">Weitere Informationen</h3>

<ul>
  <li>Den kompletten Quellcode zum heutigen Lernmoment findest du <a href="https://github.com/LernMoment/csharp/tree/master/AsyncAwaitEinfuehrung">hier</a>.</li>
</ul>

        
          <div class="subscribe-notice">
            <h5>Dieser LernMoment hat dir gefallen? <br> Dann melde dich an und du wirst über neue LernMomente informiert:</h5>
                <form action="https://lernmoment.us9.list-manage.com/subscribe/post" method="POST" target="_blank">
      <input type="hidden" name="u" value="d0206d57f5002e40b651a0f60">
      <input type="hidden" name="id" value="8845c28e62">
      <input type="email" class="subscribe-notice-input-box" autocapitalize="off" autocorrect="off" name="MERGE0" id="MERGE0" size="25" value="" placeholder="Deine E-Mail-Adresse">
      <input type="text" class="subscribe-notice-input-box" name="MERGE1" id="MERGE1" size="25" value="" placeholder="Dein Vorname (optional)">
      
        <input type="checkbox" id="group_1" name="group[20205][1]" value="1" checked="true" style="display:none">
      
      <input type="submit" class="subscribe-notice-button" name="submit" value="Ich bin dabei!">
      <legend class="subscribe-notice-legend">Du bekommst in unregelmäßigen Abständen Mails von mir, in denen ich dich auf neue Artikel oder Angebote hinweise, die in das gleiche Themengebiet fallen wie dieser Artikel.</legend>
    </form>

          </div>
        
        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
      
        <a href="http://localhost:63266/csharp-programmieren/die-klasse-file/" class="btn" title="Die Klasse File">Nächster</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<div class="social-icons">
	
	
	
	<a href="http://www.youtube.com/channel/UC5jCUQ6IPHtQP5r4y9byCqA" title="Jan Suchotzki on YouTube" target="_blank"><i class="fa fa-youtube fa-2x"></i></a>
	
	<a href="http://stackoverflow.com/users/5258906/jan-suchotzki" title="Jan Suchotzki on StackExchange" target="_blank"><i class="fa fa-stack-exchange fa-2x"></i></a>
	
	
	<a href="http://github.com/lernmoment" title="Jan Suchotzki on Github" target="_blank"><i class="fa fa-github-square fa-2x"></i></a>
	
    
	
  <a href="http://localhost:63266/feed.xml" title="Atom/RSS feed"><i class="fa fa-rss-square fa-2x"></i></a>
</div><!-- /.social-icons -->
<span>Danke an <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> und <a href="http://mademistakes.com/so-simple/" rel="nofollow">Made Mistakes</a> für hervorragende Tools.</span>
<br>
<span><a href="http://localhost:63266/kein-copyright/">Kein Copyright</a>    -    <a href="http://localhost:63266/impressum/">Impressum</a>    -    <a href="http://localhost:63266/datenschutz/">Datenschutz</a></span>

  </footer>
</div><!-- /.footer-wrapper -->

<script type="text/javascript">
  var BASE_URL = 'http://localhost:63266';
</script>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://localhost:63266/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://localhost:63266/assets/js/scripts.min.js"></script>




</body>
</html>
